{% extends "layout.html" %} {% block content %}
<h2>Multi RSI Charts</h2>

<form onsubmit="event.preventDefault(); handleAddChart();">
  <div class="flex gap-3">
    <button
      type="button"
      onclick="openRSISearchModal()"
      class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded"
    >
      üîç Add RSI Chart
    </button>
    <select id="intervalInput" class="border px-2 py-1 rounded">
      <option value="1">1s</option>
      <option value="5">5s</option>
      <option value="30">30s</option>
      <option value="60" selected>1m</option>
    </select>
  </div>
</form>

<!-- Hidden input ƒë·ªÉ nh·∫≠n symbol t·ª´ modal -->
<input type="hidden" id="tokenInput" />

<!-- Container bi·ªÉu ƒë·ªì RSI -->
<div id="rsiCharts"></div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/rsi.js') }}"></script>
<script src="{{ url_for('static', filename='js/search_for_rsi.js') }}"></script>

<!-- Modal t√¨m ki·∫øm -->
{% include 'rsi-search-modal.html' %}

<!-- H√†m x·ª≠ l√Ω th√™m chart -->
<script>
  function handleAddChart() {
    const tokenInput = document.getElementById("tokenInput").value.trim();
    const interval = parseInt(document.getElementById("intervalInput").value);

    if (!tokenInput.includes("/")) {
      return alert("Vui l√≤ng ch·ªçn token d·∫°ng A/B (VD: BTC/USDT)");
    }

    

    // chu·∫©n ƒë·ªÉ truy·ªÅn cho addRSIChart
    addRSIChart(tokenInput, interval);
  }

  // Kh√¥i ph·ª•c bi·ªÉu ƒë·ªì ƒë√£ l∆∞u khi t·∫£i trang
  restoreChartsFromStorage();
</script>
{% endblock %}
